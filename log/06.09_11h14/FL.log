[INFO](2023/06/09/ 11:14:26 AM) 
[WELCOME] Unfolding configurations...!
[INFO](2023/06/09/ 11:14:26 AM) {'global_config': {'seed': 500, 'device': 'cuda:0', 'is_mp': True}}
[INFO](2023/06/09/ 11:14:26 AM) {'data_config': {'data_path': './data/', 'save_img_path': '/mnt/sda/li/', 'dataset_name': 'MNIST', 'num_shards': 200, 'iid': False}}
[INFO](2023/06/09/ 11:14:26 AM) {'fed_config': {'C': 0.1, 'K': 3, 'R': 20, 'E': 10, 'B': 32, 'criterion': 'DiceLoss', 'optimizer': 'torch.optim.Adam'}}
[INFO](2023/06/09/ 11:14:26 AM) {'optim_config': {'lr': '2e-4', 'momentum': 0.9}}
[INFO](2023/06/09/ 11:14:26 AM) {'init_config': {'init_type': 'xavier', 'init_gain': 1.0, 'gpu_ids': [0, 1, 2]}}
[INFO](2023/06/09/ 11:14:26 AM) {'model_config': {'name': 'UNet', 'in_channels': 1, 'num_classes': 4}}
[INFO](2023/06/09/ 11:14:26 AM) {'log_config': {'log_path': './log/06.09_11h14/', 'log_name': 'FL.log', 'tb_port': 5252, 'tb_host': '0.0.0.0'}}
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0000] ...successfully initialized model (# parameters: 7765508)!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0000] ...successfully created all 3 clients!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0000] ...successfully finished setup of all 3 clients!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0000] ...successfully transmitted models to all 3 clients!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0001] Select clients...!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0001] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0001] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0001] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:14:29 AM) [Round: 0001] Start updating selected client 0001...!
[INFO](2023/06/09/ 11:19:57 AM) 	[Client 0000] ...finished training!            
	=> Tain loss: 0.5578

[INFO](2023/06/09/ 11:19:57 AM) [Round: 0001] ...client 0000 is selected and updated (with total sample size: 840)! train_loss:0.5577755101301052
[INFO](2023/06/09/ 11:20:38 AM) 	[Client 0002] ...finished training!            
	=> Tain loss: 0.6070

[INFO](2023/06/09/ 11:20:38 AM) [Round: 0001] ...client 0002 is selected and updated (with total sample size: 898)! train_loss:0.6069577850144485
[INFO](2023/06/09/ 11:23:00 AM) 	[Client 0001] ...finished training!            
	=> Tain loss: 0.4998

[INFO](2023/06/09/ 11:23:00 AM) [Round: 0001] ...client 0001 is selected and updated (with total sample size: 1730)! train_loss:0.4998048444227739
[INFO](2023/06/09/ 11:23:01 AM) [Round: 0001] Evaluate selected 3 clients' models...!
[INFO](2023/06/09/ 11:23:41 AM) 	[Client 0000] ...finished evaluation!            
	=> Test loss: 0.5185            
	=> test_dice: 48.15%

[INFO](2023/06/09/ 11:23:41 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.4815
[INFO](2023/06/09/ 11:23:41 AM) 	 Saving to ./fedbestmodels/0/
[INFO](2023/06/09/ 11:23:42 AM) 	[Client 0002] ...finished evaluation!            
	=> Test loss: 0.5649            
	=> test_dice: 43.51%

[INFO](2023/06/09/ 11:23:42 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.4351
[INFO](2023/06/09/ 11:23:42 AM) 	 Saving to ./fedbestmodels/2/
[INFO](2023/06/09/ 11:24:03 AM) 	[Client 0001] ...finished evaluation!            
	=> Test loss: 0.4391            
	=> test_dice: 56.09%

[INFO](2023/06/09/ 11:24:03 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.5609
[INFO](2023/06/09/ 11:24:03 AM) 	 Saving to ./fedbestmodels/1/
[INFO](2023/06/09/ 11:24:03 AM) [Round: 0001] Aggregate updated weights of 3 clients...!
[INFO](2023/06/09/ 11:24:03 AM) [Round: 0001] ...updated weights of 3 clients are successfully averaged!
[INFO](2023/06/09/ 11:24:06 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.2872
[INFO](2023/06/09/ 11:24:06 AM) 	 Saving to ./global_model
[INFO](2023/06/09/ 11:24:06 AM) [Round: 0001] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.7128                
	=> Dice: 28.72%

[INFO](2023/06/09/ 11:24:06 AM) [Round: 0002] Select clients...!
[INFO](2023/06/09/ 11:24:06 AM) [Round: 0002] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:24:06 AM) [Round: 0002] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:24:06 AM) [Round: 0002] Start updating selected client 0001...!
[INFO](2023/06/09/ 11:24:06 AM) [Round: 0002] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:27:50 AM) 	[Client 0000] ...finished training!            
	=> Tain loss: 0.3484

[INFO](2023/06/09/ 11:27:50 AM) [Round: 0002] ...client 0000 is selected and updated (with total sample size: 840)! train_loss:0.3483995869755745
[INFO](2023/06/09/ 11:29:06 AM) 	[Client 0002] ...finished training!            
	=> Tain loss: 0.4255

[INFO](2023/06/09/ 11:29:06 AM) [Round: 0002] ...client 0002 is selected and updated (with total sample size: 898)! train_loss:0.42551505041533505
[INFO](2023/06/09/ 11:30:29 AM) 	[Client 0001] ...finished training!            
	=> Tain loss: 0.2720

[INFO](2023/06/09/ 11:30:29 AM) [Round: 0002] ...client 0001 is selected and updated (with total sample size: 1730)! train_loss:0.2719907175681808
[INFO](2023/06/09/ 11:30:29 AM) [Round: 0002] Evaluate selected 3 clients' models...!
[INFO](2023/06/09/ 11:30:37 AM) 	[Client 0002] ...finished evaluation!            
	=> Test loss: 0.4439            
	=> test_dice: 55.61%

[INFO](2023/06/09/ 11:30:37 AM) 	 Saving best model, mean dice increased from: 0.4351 to 0.5561
[INFO](2023/06/09/ 11:30:37 AM) 	 Saving to ./fedbestmodels/2/
[INFO](2023/06/09/ 11:30:37 AM) 	[Client 0000] ...finished evaluation!            
	=> Test loss: 0.3472            
	=> test_dice: 65.28%

[INFO](2023/06/09/ 11:30:37 AM) 	 Saving best model, mean dice increased from: 0.4815 to 0.6528
[INFO](2023/06/09/ 11:30:37 AM) 	 Saving to ./fedbestmodels/0/
[INFO](2023/06/09/ 11:30:40 AM) 	[Client 0001] ...finished evaluation!            
	=> Test loss: 0.2350            
	=> test_dice: 76.50%

[INFO](2023/06/09/ 11:30:40 AM) 	 Saving best model, mean dice increased from: 0.5609 to 0.7650
[INFO](2023/06/09/ 11:30:40 AM) 	 Saving to ./fedbestmodels/1/
[INFO](2023/06/09/ 11:30:41 AM) [Round: 0002] Aggregate updated weights of 3 clients...!
[INFO](2023/06/09/ 11:30:41 AM) [Round: 0002] ...updated weights of 3 clients are successfully averaged!
[INFO](2023/06/09/ 11:30:43 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.5884
[INFO](2023/06/09/ 11:30:43 AM) 	 Saving to ./global_model
[INFO](2023/06/09/ 11:30:43 AM) [Round: 0002] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.4116                
	=> Dice: 58.84%

[INFO](2023/06/09/ 11:30:43 AM) [Round: 0003] Select clients...!
[INFO](2023/06/09/ 11:30:43 AM) [Round: 0003] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:30:43 AM) [Round: 0003] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:30:43 AM) [Round: 0003] Start updating selected client 0001...!
[INFO](2023/06/09/ 11:30:43 AM) [Round: 0003] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:35:41 AM) 	[Client 0002] ...finished training!            
	=> Tain loss: 0.2690

[INFO](2023/06/09/ 11:35:41 AM) [Round: 0003] ...client 0002 is selected and updated (with total sample size: 898)! train_loss:0.2689569186033874
[INFO](2023/06/09/ 11:35:54 AM) 	[Client 0000] ...finished training!            
	=> Tain loss: 0.1841

[INFO](2023/06/09/ 11:35:54 AM) [Round: 0003] ...client 0000 is selected and updated (with total sample size: 840)! train_loss:0.18406695480699892
[INFO](2023/06/09/ 11:37:03 AM) 	[Client 0001] ...finished training!            
	=> Tain loss: 0.1443

[INFO](2023/06/09/ 11:37:03 AM) [Round: 0003] ...client 0001 is selected and updated (with total sample size: 1730)! train_loss:0.14434196363795887
[INFO](2023/06/09/ 11:37:03 AM) [Round: 0003] Evaluate selected 3 clients' models...!
[INFO](2023/06/09/ 11:37:33 AM) 	[Client 0002] ...finished evaluation!            
	=> Test loss: 0.3230            
	=> test_dice: 67.70%

[INFO](2023/06/09/ 11:37:33 AM) 	 Saving best model, mean dice increased from: 0.5561 to 0.6770
[INFO](2023/06/09/ 11:37:33 AM) 	 Saving to ./fedbestmodels/2/
[INFO](2023/06/09/ 11:37:38 AM) 	[Client 0000] ...finished evaluation!            
	=> Test loss: 0.2403            
	=> test_dice: 75.97%

[INFO](2023/06/09/ 11:37:38 AM) 	 Saving best model, mean dice increased from: 0.6528 to 0.7597
[INFO](2023/06/09/ 11:37:38 AM) 	 Saving to ./fedbestmodels/0/
[INFO](2023/06/09/ 11:38:12 AM) 	[Client 0001] ...finished evaluation!            
	=> Test loss: 0.2310            
	=> test_dice: 76.90%

[INFO](2023/06/09/ 11:38:12 AM) 	 Saving best model, mean dice increased from: 0.7650 to 0.7690
[INFO](2023/06/09/ 11:38:12 AM) 	 Saving to ./fedbestmodels/1/
[INFO](2023/06/09/ 11:38:12 AM) [Round: 0003] Aggregate updated weights of 3 clients...!
[INFO](2023/06/09/ 11:38:12 AM) [Round: 0003] ...updated weights of 3 clients are successfully averaged!
[INFO](2023/06/09/ 11:38:22 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.6977
[INFO](2023/06/09/ 11:38:22 AM) 	 Saving to ./global_model
[INFO](2023/06/09/ 11:38:23 AM) [Round: 0003] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.3023                
	=> Dice: 69.77%

[INFO](2023/06/09/ 11:38:23 AM) [Round: 0004] Select clients...!
[INFO](2023/06/09/ 11:38:23 AM) [Round: 0004] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:38:23 AM) [Round: 0004] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:38:23 AM) [Round: 0004] Start updating selected client 0001...!
[INFO](2023/06/09/ 11:38:23 AM) [Round: 0004] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:42:54 AM) 	[Client 0000] ...finished training!            
	=> Tain loss: 0.1487

[INFO](2023/06/09/ 11:42:54 AM) [Round: 0004] ...client 0000 is selected and updated (with total sample size: 840)! train_loss:0.14874640250647508
[INFO](2023/06/09/ 11:43:46 AM) 	[Client 0002] ...finished training!            
	=> Tain loss: 0.2390

[INFO](2023/06/09/ 11:43:46 AM) [Round: 0004] ...client 0002 is selected and updated (with total sample size: 898)! train_loss:0.23898158222436905
[INFO](2023/06/09/ 11:44:28 AM) 	[Client 0001] ...finished training!            
	=> Tain loss: 0.1227

[INFO](2023/06/09/ 11:44:28 AM) [Round: 0004] ...client 0001 is selected and updated (with total sample size: 1730)! train_loss:0.12269929455085234
[INFO](2023/06/09/ 11:44:28 AM) [Round: 0004] Evaluate selected 3 clients' models...!
[INFO](2023/06/09/ 11:44:44 AM) 	[Client 0002] ...finished evaluation!            
	=> Test loss: 0.3346            
	=> test_dice: 66.54%

[INFO](2023/06/09/ 11:44:46 AM) 	[Client 0000] ...finished evaluation!            
	=> Test loss: 0.2185            
	=> test_dice: 78.15%

[INFO](2023/06/09/ 11:44:46 AM) 	 Saving best model, mean dice increased from: 0.7597 to 0.7815
[INFO](2023/06/09/ 11:44:46 AM) 	 Saving to ./fedbestmodels/0/
[INFO](2023/06/09/ 11:44:56 AM) 	[Client 0001] ...finished evaluation!            
	=> Test loss: 0.1993            
	=> test_dice: 80.07%

[INFO](2023/06/09/ 11:44:56 AM) 	 Saving best model, mean dice increased from: 0.7690 to 0.8007
[INFO](2023/06/09/ 11:44:56 AM) 	 Saving to ./fedbestmodels/1/
[INFO](2023/06/09/ 11:44:56 AM) [Round: 0004] Aggregate updated weights of 3 clients...!
[INFO](2023/06/09/ 11:44:56 AM) [Round: 0004] ...updated weights of 3 clients are successfully averaged!
[INFO](2023/06/09/ 11:45:00 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.7394
[INFO](2023/06/09/ 11:45:00 AM) 	 Saving to ./global_model
[INFO](2023/06/09/ 11:45:00 AM) [Round: 0004] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.2606                
	=> Dice: 73.94%

[INFO](2023/06/09/ 11:45:00 AM) [Round: 0005] Select clients...!
[INFO](2023/06/09/ 11:45:00 AM) [Round: 0005] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:45:00 AM) [Round: 0005] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:45:00 AM) [Round: 0005] Start updating selected client 0001...!
[INFO](2023/06/09/ 11:45:00 AM) [Round: 0005] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:49:32 AM) 	[Client 0000] ...finished training!            
	=> Tain loss: 0.1328

[INFO](2023/06/09/ 11:49:32 AM) [Round: 0005] ...client 0000 is selected and updated (with total sample size: 840)! train_loss:0.13277203876663138
[INFO](2023/06/09/ 11:50:18 AM) 	[Client 0002] ...finished training!            
	=> Tain loss: 0.2206

[INFO](2023/06/09/ 11:50:18 AM) [Round: 0005] ...client 0002 is selected and updated (with total sample size: 898)! train_loss:0.22064223227829768
[INFO](2023/06/09/ 11:51:07 AM) 	[Client 0001] ...finished training!            
	=> Tain loss: 0.1073

[INFO](2023/06/09/ 11:51:07 AM) [Round: 0005] ...client 0001 is selected and updated (with total sample size: 1730)! train_loss:0.10729508990591223
[INFO](2023/06/09/ 11:51:07 AM) [Round: 0005] Evaluate selected 3 clients' models...!
[INFO](2023/06/09/ 11:51:51 AM) 	[Client 0000] ...finished evaluation!            
	=> Test loss: 0.2149            
	=> test_dice: 78.51%

[INFO](2023/06/09/ 11:51:51 AM) 	 Saving best model, mean dice increased from: 0.7815 to 0.7851
[INFO](2023/06/09/ 11:51:51 AM) 	 Saving to ./fedbestmodels/0/
[INFO](2023/06/09/ 11:51:56 AM) 	[Client 0002] ...finished evaluation!            
	=> Test loss: 0.3332            
	=> test_dice: 66.68%

[INFO](2023/06/09/ 11:52:17 AM) 	[Client 0001] ...finished evaluation!            
	=> Test loss: 0.2027            
	=> test_dice: 79.73%

[INFO](2023/06/09/ 11:52:17 AM) [Round: 0005] Aggregate updated weights of 3 clients...!
[INFO](2023/06/09/ 11:52:17 AM) [Round: 0005] ...updated weights of 3 clients are successfully averaged!
[INFO](2023/06/09/ 11:52:22 AM) 	 Saving best model, mean dice increased from: 0.0000 to 0.7748
[INFO](2023/06/09/ 11:52:22 AM) 	 Saving to ./global_model
[INFO](2023/06/09/ 11:52:22 AM) [Round: 0005] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.2252                
	=> Dice: 77.48%

[INFO](2023/06/09/ 11:52:22 AM) [Round: 0006] Select clients...!
[INFO](2023/06/09/ 11:52:22 AM) [Round: 0006] ...successfully transmitted models to 3 selected clients!
[INFO](2023/06/09/ 11:52:22 AM) [Round: 0006] Start updating selected client 0000...!
[INFO](2023/06/09/ 11:52:22 AM) [Round: 0006] Start updating selected client 0002...!
[INFO](2023/06/09/ 11:52:22 AM) [Round: 0006] Start updating selected client 0001...!
